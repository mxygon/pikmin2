.include "macros.inc"

.section .text, "ax"  # 0x800056C0 - 0x80472F00
.global TRKDestructEvent
TRKDestructEvent:
/* 800BB488 000B83C8  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 800BB48C 000B83CC  7C 08 02 A6 */	mflr r0
/* 800BB490 000B83D0  90 01 00 14 */	stw r0, 0x14(r1)
/* 800BB494 000B83D4  80 63 00 08 */	lwz r3, 8(r3)
/* 800BB498 000B83D8  48 00 0A 65 */	bl TRKReleaseBuffer
/* 800BB49C 000B83DC  80 01 00 14 */	lwz r0, 0x14(r1)
/* 800BB4A0 000B83E0  7C 08 03 A6 */	mtlr r0
/* 800BB4A4 000B83E4  38 21 00 10 */	addi r1, r1, 0x10
/* 800BB4A8 000B83E8  4E 80 00 20 */	blr 

.global TRKConstructEvent
TRKConstructEvent:
/* 800BB4AC 000B83EC  90 83 00 00 */	stw r4, 0(r3)
/* 800BB4B0 000B83F0  38 80 00 00 */	li r4, 0
/* 800BB4B4 000B83F4  38 00 FF FF */	li r0, -1
/* 800BB4B8 000B83F8  90 83 00 04 */	stw r4, 4(r3)
/* 800BB4BC 000B83FC  90 03 00 08 */	stw r0, 8(r3)
/* 800BB4C0 000B8400  4E 80 00 20 */	blr 

.global TRKPostEvent
TRKPostEvent:
/* 800BB4C4 000B8404  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800BB4C8 000B8408  7C 08 02 A6 */	mflr r0
/* 800BB4CC 000B840C  3C 80 80 4F */	lis r4, gTRKEventQueue@ha
/* 800BB4D0 000B8410  90 01 00 24 */	stw r0, 0x24(r1)
/* 800BB4D4 000B8414  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800BB4D8 000B8418  3B E0 00 00 */	li r31, 0
/* 800BB4DC 000B841C  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800BB4E0 000B8420  93 A1 00 14 */	stw r29, 0x14(r1)
/* 800BB4E4 000B8424  7C 7D 1B 78 */	mr r29, r3
/* 800BB4E8 000B8428  38 64 28 80 */	addi r3, r4, gTRKEventQueue@l
/* 800BB4EC 000B842C  48 00 28 25 */	bl TRKAcquireMutex
/* 800BB4F0 000B8430  3C 60 80 4F */	lis r3, gTRKEventQueue@ha
/* 800BB4F4 000B8434  3B C3 28 80 */	addi r30, r3, gTRKEventQueue@l
/* 800BB4F8 000B8438  80 7E 00 04 */	lwz r3, 4(r30)
/* 800BB4FC 000B843C  2C 03 00 02 */	cmpwi r3, 2
/* 800BB500 000B8440  40 82 00 0C */	bne lbl_800BB50C
/* 800BB504 000B8444  3B E0 01 00 */	li r31, 0x100
/* 800BB508 000B8448  48 00 00 70 */	b lbl_800BB578
lbl_800BB50C:
/* 800BB50C 000B844C  80 1E 00 08 */	lwz r0, 8(r30)
/* 800BB510 000B8450  7F A4 EB 78 */	mr r4, r29
/* 800BB514 000B8454  38 A0 00 0C */	li r5, 0xc
/* 800BB518 000B8458  7C 00 1A 14 */	add r0, r0, r3
/* 800BB51C 000B845C  54 03 0F FE */	srwi r3, r0, 0x1f
/* 800BB520 000B8460  54 00 07 FE */	clrlwi r0, r0, 0x1f
/* 800BB524 000B8464  7C 00 1A 78 */	xor r0, r0, r3
/* 800BB528 000B8468  7C 03 00 50 */	subf r0, r3, r0
/* 800BB52C 000B846C  1F A0 00 0C */	mulli r29, r0, 0xc
/* 800BB530 000B8470  7C 7E EA 14 */	add r3, r30, r29
/* 800BB534 000B8474  38 63 00 0C */	addi r3, r3, 0xc
/* 800BB538 000B8478  4B F4 7B F9 */	bl TRK_memcpy
/* 800BB53C 000B847C  3C 60 80 4F */	lis r3, gTRKEventQueue@ha
/* 800BB540 000B8480  38 83 28 80 */	addi r4, r3, gTRKEventQueue@l
/* 800BB544 000B8484  80 04 00 24 */	lwz r0, 0x24(r4)
/* 800BB548 000B8488  7C 64 EA 14 */	add r3, r4, r29
/* 800BB54C 000B848C  90 03 00 10 */	stw r0, 0x10(r3)
/* 800BB550 000B8490  80 64 00 24 */	lwz r3, 0x24(r4)
/* 800BB554 000B8494  38 03 00 01 */	addi r0, r3, 1
/* 800BB558 000B8498  28 00 01 00 */	cmplwi r0, 0x100
/* 800BB55C 000B849C  90 04 00 24 */	stw r0, 0x24(r4)
/* 800BB560 000B84A0  40 80 00 0C */	bge lbl_800BB56C
/* 800BB564 000B84A4  38 00 01 00 */	li r0, 0x100
/* 800BB568 000B84A8  90 04 00 24 */	stw r0, 0x24(r4)
lbl_800BB56C:
/* 800BB56C 000B84AC  80 7E 00 04 */	lwz r3, 4(r30)
/* 800BB570 000B84B0  38 03 00 01 */	addi r0, r3, 1
/* 800BB574 000B84B4  90 1E 00 04 */	stw r0, 4(r30)
lbl_800BB578:
/* 800BB578 000B84B8  3C 60 80 4F */	lis r3, gTRKEventQueue@ha
/* 800BB57C 000B84BC  38 63 28 80 */	addi r3, r3, gTRKEventQueue@l
/* 800BB580 000B84C0  48 00 27 89 */	bl TRKReleaseMutex
/* 800BB584 000B84C4  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800BB588 000B84C8  7F E3 FB 78 */	mr r3, r31
/* 800BB58C 000B84CC  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800BB590 000B84D0  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800BB594 000B84D4  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 800BB598 000B84D8  7C 08 03 A6 */	mtlr r0
/* 800BB59C 000B84DC  38 21 00 20 */	addi r1, r1, 0x20
/* 800BB5A0 000B84E0  4E 80 00 20 */	blr 

.global TRKGetNextEvent
TRKGetNextEvent:
/* 800BB5A4 000B84E4  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800BB5A8 000B84E8  7C 08 02 A6 */	mflr r0
/* 800BB5AC 000B84EC  3C 80 80 4F */	lis r4, gTRKEventQueue@ha
/* 800BB5B0 000B84F0  90 01 00 24 */	stw r0, 0x24(r1)
/* 800BB5B4 000B84F4  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800BB5B8 000B84F8  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800BB5BC 000B84FC  3B C0 00 00 */	li r30, 0
/* 800BB5C0 000B8500  93 A1 00 14 */	stw r29, 0x14(r1)
/* 800BB5C4 000B8504  7C 7D 1B 78 */	mr r29, r3
/* 800BB5C8 000B8508  38 64 28 80 */	addi r3, r4, gTRKEventQueue@l
/* 800BB5CC 000B850C  48 00 27 45 */	bl TRKAcquireMutex
/* 800BB5D0 000B8510  3C 60 80 4F */	lis r3, gTRKEventQueue@ha
/* 800BB5D4 000B8514  3B E3 28 80 */	addi r31, r3, gTRKEventQueue@l
/* 800BB5D8 000B8518  80 1F 00 04 */	lwz r0, 4(r31)
/* 800BB5DC 000B851C  2C 00 00 00 */	cmpwi r0, 0
/* 800BB5E0 000B8520  40 81 00 4C */	ble lbl_800BB62C
/* 800BB5E4 000B8524  80 1F 00 08 */	lwz r0, 8(r31)
/* 800BB5E8 000B8528  7F A3 EB 78 */	mr r3, r29
/* 800BB5EC 000B852C  38 A0 00 0C */	li r5, 0xc
/* 800BB5F0 000B8530  1C 00 00 0C */	mulli r0, r0, 0xc
/* 800BB5F4 000B8534  7C 9F 02 14 */	add r4, r31, r0
/* 800BB5F8 000B8538  38 84 00 0C */	addi r4, r4, 0xc
/* 800BB5FC 000B853C  4B F4 7B 35 */	bl TRK_memcpy
/* 800BB600 000B8540  80 7F 00 08 */	lwz r3, 8(r31)
/* 800BB604 000B8544  80 9F 00 04 */	lwz r4, 4(r31)
/* 800BB608 000B8548  38 03 00 01 */	addi r0, r3, 1
/* 800BB60C 000B854C  38 64 FF FF */	addi r3, r4, -1
/* 800BB610 000B8550  90 1F 00 08 */	stw r0, 8(r31)
/* 800BB614 000B8554  2C 00 00 02 */	cmpwi r0, 2
/* 800BB618 000B8558  90 7F 00 04 */	stw r3, 4(r31)
/* 800BB61C 000B855C  40 82 00 0C */	bne lbl_800BB628
/* 800BB620 000B8560  38 00 00 00 */	li r0, 0
/* 800BB624 000B8564  90 1F 00 08 */	stw r0, 8(r31)
lbl_800BB628:
/* 800BB628 000B8568  3B C0 00 01 */	li r30, 1
lbl_800BB62C:
/* 800BB62C 000B856C  3C 60 80 4F */	lis r3, gTRKEventQueue@ha
/* 800BB630 000B8570  38 63 28 80 */	addi r3, r3, gTRKEventQueue@l
/* 800BB634 000B8574  48 00 26 D5 */	bl TRKReleaseMutex
/* 800BB638 000B8578  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800BB63C 000B857C  7F C3 F3 78 */	mr r3, r30
/* 800BB640 000B8580  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800BB644 000B8584  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800BB648 000B8588  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 800BB64C 000B858C  7C 08 03 A6 */	mtlr r0
/* 800BB650 000B8590  38 21 00 20 */	addi r1, r1, 0x20
/* 800BB654 000B8594  4E 80 00 20 */	blr 

.global TRKInitializeEventQueue
TRKInitializeEventQueue:
/* 800BB658 000B8598  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 800BB65C 000B859C  7C 08 02 A6 */	mflr r0
/* 800BB660 000B85A0  3C 60 80 4F */	lis r3, gTRKEventQueue@ha
/* 800BB664 000B85A4  90 01 00 14 */	stw r0, 0x14(r1)
/* 800BB668 000B85A8  38 63 28 80 */	addi r3, r3, gTRKEventQueue@l
/* 800BB66C 000B85AC  48 00 26 AD */	bl TRKInitializeMutex
/* 800BB670 000B85B0  3C 60 80 4F */	lis r3, gTRKEventQueue@ha
/* 800BB674 000B85B4  38 63 28 80 */	addi r3, r3, gTRKEventQueue@l
/* 800BB678 000B85B8  48 00 26 99 */	bl TRKAcquireMutex
/* 800BB67C 000B85BC  3C 60 80 4F */	lis r3, gTRKEventQueue@ha
/* 800BB680 000B85C0  38 80 00 00 */	li r4, 0
/* 800BB684 000B85C4  38 63 28 80 */	addi r3, r3, gTRKEventQueue@l
/* 800BB688 000B85C8  38 00 01 00 */	li r0, 0x100
/* 800BB68C 000B85CC  90 83 00 04 */	stw r4, 4(r3)
/* 800BB690 000B85D0  90 83 00 08 */	stw r4, 8(r3)
/* 800BB694 000B85D4  90 03 00 24 */	stw r0, 0x24(r3)
/* 800BB698 000B85D8  48 00 26 71 */	bl TRKReleaseMutex
/* 800BB69C 000B85DC  80 01 00 14 */	lwz r0, 0x14(r1)
/* 800BB6A0 000B85E0  38 60 00 00 */	li r3, 0
/* 800BB6A4 000B85E4  7C 08 03 A6 */	mtlr r0
/* 800BB6A8 000B85E8  38 21 00 10 */	addi r1, r1, 0x10
/* 800BB6AC 000B85EC  4E 80 00 20 */	blr 
